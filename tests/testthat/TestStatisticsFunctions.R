################################################################################
# TestStatisticsFunctions.R
################################################################################
# 2018-09-20
# Curtis Miller
################################################################################
# Test statistics functions for proper behavior.
################################################################################

################################################################################
# SCAFFOLDING
################################################################################

context("Statistics functions")
library(CPAT)

has_cointReg <- requireNamespace("cointReg", quietly = TRUE)

#' Check for cointReg
#'
#' Check for the cointReg package; if not present, skip the test.
#' 
#' @examples
#' check_cointReg()
check_cointReg <- function() {
  if (!has_cointReg) {
    skip("cointReg not available")
  }
}

# Dataset for testing
dat <- c(-0.638760798582081, -1.166854546290460,  0.7562170206599880,
          1.773193112377020,  1.765144901085300, -0.2835114951085060,
         -0.201687491732536,  0.826133571040039, -0.0780687473143249,
          2.570039285092590, -0.128067596009128, -1.2248640405953800,
          0.466093259975891, -0.319977344896947,  0.1752074303141530,
         -1.382926811839120,  0.212967137414989,  0.3762585339616080,
          0.154790664947175, -0.305586505979627)

################################################################################
# UNDERLYING FUNCTION TESTING
################################################################################

test_that("stat_Zn() functions properly", {
  # TODO: curtis: TESTS FOR stat_Zn() -- Thu 20 Sep 2018 11:56:03 PM MDT
})

test_that("get_lrv_vec() functions properly, interfaces where it should", {
  check_cointReg()

  expect_equal(CPAT:::get_lrv_vec(dat),
               c(0.943987548223733, 0.854976188756370, 0.939180260657493,
                 0.988680293245614, 0.950641641134650, 0.966679404875305,
                 0.977332230198202, 0.962534614578588, 0.963407378445432,
                 0.844791683964846, 0.857811058740702, 0.934102046479819,
                 0.924527515446825, 0.941900226447094, 0.944593815683739,
                 0.986910532565228, 0.987076690647789, 0.981879726182090,
                 0.976705259812553))
})
